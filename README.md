# AWS-BIA (AWS Bedrock Intelligent Agents CLI)

A command-line interface tool for interacting with AWS Bedrock Intelligent Agents.

## Installation

```bash
go install github.com/hacker65536/aws-bia@latest
```

Or clone the repository and build it manually:

```bash
git clone https://github.com/hacker65536/aws-bia.git
cd aws-bia
go build -o aws-bia
```

## Configuration

AWS-BIA uses the standard AWS configuration from your environment. Make sure you have:

1. AWS credentials properly configured in `~/.aws/credentials` or via environment variables
2. The necessary IAM permissions to use AWS Bedrock services

## Usage

### Invoke a Bedrock Agent

```bash
# Basic usage
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question to the agent"

# With session ID for conversation continuity
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --session-id your-session-id --input "Follow-up question"

# With streaming enabled (shows real-time responses)
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --stream

# Specify AWS region
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --region us-west-2

# Using JSON output format
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --format json

# Save response to a file
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --output-file response.txt

# With verbose logging
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --verbose

# Upload files to the agent (for code interpreter)
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Analyze this data" --upload-files data.csv,schema.json

# Upload files with specific use case
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Analyze this data" --upload-files data.csv --file-use-case CODE_INTERPRETER

# Combining options
aws-bia invoke --agent-id your-agent-id --agent-alias-id your-alias-id --input "Your question" --stream --format json --output-file response.json
```

## Streaming Mode

When using the `--stream` flag, the CLI will display agent responses in real-time as they are received from the AWS Bedrock service. This provides a more interactive experience, especially for longer responses or when the agent generates files.

### Features of Streaming Mode

- **Real-time Text Output**: See the agent's response as it's being generated
- **File Generation**: Handles files generated by the agent (e.g., from Code Interpreter actions)
- **Citations**: Properly displays citation information when the agent references sources
- **Return Control**: Shows when an agent returns control for custom action flows

### JSON Output with Streaming

When combining `--stream` with `--format json`, the CLI will collect all streaming events and provide a comprehensive JSON response at the end that includes:

- Complete text response
- Session information
- Any generated files (with metadata)
- Citations and references
- Return control information

This is useful for programmatic integration with other tools and scripts.

## File Upload Support

AWS-BIA supports uploading files to your Bedrock Agent. This is particularly useful when working with agents that use the Code Interpreter capability.

### File Upload Features

- Upload up to 5 files at once (total size limit: 10MB)
- Automatic MIME type detection for proper handling by the agent
- Support for various file types including CSV, JSON, PDF, images, etc.
- Customizable file use case (e.g., CODE_INTERPRETER)

### Using File Upload

```bash
# Upload a single file
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "Analyze this data" --upload-files data.csv

# Upload multiple files
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "Compare these datasets" --upload-files data1.csv,data2.csv

# Specify file use case
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "Analyze this data" --upload-files data.csv --file-use-case CODE_INTERPRETER
```

## Examples

Example 1: Simple agent interaction
```bash
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "What's the weather like in Seattle?"
```

Example 2: Multi-turn conversation
```bash
# First interaction - note the session ID that's generated
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "Find me flights to Tokyo"

# Follow-up using the same session
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --session-id session123 --input "What about flights to Osaka instead?"
```

Example 3: Working with a data file
```bash
# Upload a CSV file for analysis
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --input "Analyze this sales data and create a report" --upload-files sales_data.csv

# In a follow-up, you can reference the uploaded file
aws-bia invoke --agent-id abc123 --agent-alias-id def456 --session-id session123 --input "Now create a chart showing the top 5 products"
```

## License

See the [LICENSE](LICENSE) file for details.